<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MilkWheyAndCo - Heat Stability</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">MilkWheyAndCo</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../Reference/reference.html" rel="" target="" aria-current="page">
 <span class="menu-text">Reference</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Concepts/concepts.html" rel="" target="">
 <span class="menu-text">Concepts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Tutorials/tutorials.html" rel="" target="">
 <span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Howto/howto.html" rel="" target="">
 <span class="menu-text">How-To</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../About/about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Reference/heat_stability.html">Heat Stability</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/reference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/SMP_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SMP Process</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/WMP_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">WMP Process</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/RCN_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RCN Process</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/ACN_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ACN Process</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/precipitate_washing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multi-stage Washing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/fines_recovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fines Recovery</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/whey_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">WP Process</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/wpc_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">WPC Process</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/wpi_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">WPI Process</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/lactose_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lactose Process</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/heat_stability.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Heat Stability</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/milk_minerals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Milk Minerals</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/lactose_chemistry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lactose Chemistry</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Reference/lactose_intolerance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lactose Intolerance</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#heat-coagulation-time" id="toc-heat-coagulation-time" class="nav-link active" data-scroll-target="#heat-coagulation-time">Heat Coagulation Time</a>
  <ul class="collapse">
  <li><a href="#explanation-of-the-ph-hct-curve" id="toc-explanation-of-the-ph-hct-curve" class="nav-link" data-scroll-target="#explanation-of-the-ph-hct-curve">Explanation of the pH-HCT curve</a></li>
  </ul></li>
  <li><a href="#heat-induced-changes" id="toc-heat-induced-changes" class="nav-link" data-scroll-target="#heat-induced-changes">Heat-induced changes</a></li>
  <li><a href="#controlling-heat-stability" id="toc-controlling-heat-stability" class="nav-link" data-scroll-target="#controlling-heat-stability">Controlling Heat Stability</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/edibotopic/MilkWheyAndCo/edit/main/Reference/heat_stability.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/edibotopic/MilkWheyAndCo/issues/new" class="toc-action">Report an issue</a></p><p><a href="https://github.com/edibotopic/MilkWheyAndCo/blob/main/Reference/heat_stability.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Heat Stability</h1>
  <div class="quarto-categories">
    <div class="quarto-category">reference</div>
    <div class="quarto-category">heat stability</div>
    <div class="quarto-category">denaturation</div>
    <div class="quarto-category">heating</div>
    <div class="quarto-category">milk powder</div>
    <div class="quarto-category">pre-heating</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Heat stability is an important property of dairy beverages, including but not limited to milk.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>We take that HCT is a function of pH:</p>
<p><span class="math display">\[HCT = f(pH)\]</span></p>
<p>but must understand that changes in <span class="math inline">\(pH\)</span> cause an array of physicochemical changes <span class="math inline">\(z_n\)</span> that are responsible for any decrease or increase in <span class="math inline">\(HCT\)</span>:</p>
<p><span class="math display">\[pH \rightarrow {z_1,z_2,...,z_n}\]</span></p>
</div></div><p>Heat stability is a measure of the time for which a liquid system can be heated before physical manifestations of instability are observed. It is commonly measured as Heat Coagulation Time (HCT).</p>
<section id="heat-coagulation-time" class="level1 page-columns page-full">
<h1>Heat Coagulation Time</h1>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">Recall my comments on the <code>oil bath</code> method of determining HCT from the lectures. The method is relatively simple and unsophisticated. While it yields valuable insights into the heat stability of samples it should not be considered a predictive test suitable for planning time-temperature combinations in a factory.</span></div></div>
<p>HCT is almost always measured as a function of pH. A range of pH values (<span class="math inline">\(n \approx 8\)</span>) are selected with multiple data points either side of — and including — the natural pH of the system.</p>
<p>For milk systems an S-shaped curve is most common. This curve has a well-defined <em>maximum</em> (<code>max</code>) and <em>minimum</em> (<code>min</code>). In general, the following observations can be made:</p>
<ul>
<li>Low stability in acidic regions</li>
<li>High stability around native pH</li>
<li>Recovery of stability in alkaline regions</li>
</ul>
<p>In most practical contexts a high HCT value is preferable. For this reason, regions of minimum stability are systematically avoided.</p>
<p>Decades of research have been invested in measuring the heat stability of liquid milk and related beverages. This is a testament to the complexity of the problem and its practical importance in the food industry.</p>
<section id="explanation-of-the-ph-hct-curve" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="explanation-of-the-ph-hct-curve">Explanation of the pH-HCT curve</h2>

<div class="no-row-height column-margin column-container"><div class="">
<table class="table">
<caption>Example dataset for a pH-HCT curve. These data would be collected using the oil bath test discussed in lectures</caption>
<thead>
<tr class="header">
<th>pH (-)</th>
<th>HCT (min)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6.0</td>
<td>&lt;1</td>
</tr>
<tr class="even">
<td>6.2</td>
<td>2</td>
</tr>
<tr class="odd">
<td>6.4</td>
<td>7</td>
</tr>
<tr class="even">
<td>6.6</td>
<td>10</td>
</tr>
<tr class="odd">
<td>6.7</td>
<td>12</td>
</tr>
<tr class="even">
<td>6.8</td>
<td>5</td>
</tr>
<tr class="odd">
<td>7.0</td>
<td>8</td>
</tr>
<tr class="even">
<td>7.2</td>
<td>10</td>
</tr>
<tr class="odd">
<td>7.4</td>
<td>11</td>
</tr>
</tbody>
</table>
</div></div><p>All explanations of the pH-HCT curve typically start with the <code>max</code> and <code>min</code>. Both are related to interactions occuring between casein micelles and whey proteins.</p>
<p>In the region of the <code>max</code> whey proteins denature during heating, which promotes their interaction with <span class="math inline">\(\kappa\)</span>-casein at the surface of micelles.</p>
<p>In the <code>min</code> the same interactions occur. The critical difference is that while in the first case the complexes that are formed are found on the surface of the micelles, in the second case they dissociate from the micelles and are found in the serum phase. When proteins are associated with the stabilising “hairy layer” at the micelle surface they promote stability, but when they cause dissociation of that layer they decrease stability.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This has been shown in experiments where — for example — milk samples are filtered after heating to separate the (large) micelles from the (small) whey proteins. In samples heated in the <code>max</code> region the whey proteins are recovered with the micelles, while in the <code>min</code> region small complexes of whey proteins and <span class="math inline">\(\kappa\)</span>-casein are found in the filtrate.</p>
</div>
</div>
<p>Outside of these regions of <code>min</code> and <code>max</code> stability the influence of pH on calcium-ion activity is the dominant factor. As you will see in the <code>Milk Minerals</code> section, a significant proportion of the calcium in milk is associated with the casein micelles. This form of calcium salt is more soluble at acidic pH. Thus, as pH decreases more Ca ions dissociate into the serum phase.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>In general, an increase in the level of calcium ions will cause problems in milk protein systems that are to be heated, as the majority of milk proteins are negatively charged and therefore prone to destabilisation by positively charged ions due to charge screening and cross-bridging.</p>
</div>
</div>
</section>
</section>
<section id="heat-induced-changes" class="level1">
<h1>Heat-induced changes</h1>
<p>Several physico-chemical changes occur during the heating of milk, including:</p>
<ul>
<li>Acidification</li>
<li>Protein denaturation/aggregation</li>
<li>Calcium phosphate precipitation</li>
<li>Dephosphorylation of casein</li>
<li>Breakdown of urea</li>
</ul>
<p>Some of these phenomenon are better studied than others. In addition, there are effects that — in a sense — “compete” with each other for influence. Understanding some of these factors can help when attempting to troubleshoot any issues relating to the destabilisation of milk.</p>
<p>One important factor is <em>acidification</em>, which is itself a function of a number of causes. Firstly, calcium phosphate is less soluble at high temperatures, and when calcium phosphate is formed in milk hydrogen ions are released causing acidification. Secondly, a proportion of the lactose present in milk is chemically transformed into formic acid, which also contributes to acidification.</p>
<p>It is generally taken that calcium phosphate formation has the dominant role here, for the simple reason that while milk reaches a very low pH when heated &gt;100 degrees Celsius, the pH is generally restored to a value close to the native pH of milk on cooling. As the formation of calcium phosphate is reversible, but the formation of formic acid is not, this indicates that calcium phosphate formation plays a more important role.</p>
<p>Another factor opposes this acidification effect, and that is the breakdown of urea to ammonia. Ammonia is a buffer, and limits the acidification that occurs during heating. It has been shown that addition of urea either in the diet of the cow or directly in the milk to be heated improves heat stability for this reason.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The influence of <em>other factors</em> — maillard browning, dephosphorylation — is less well understood. It is thought that these may have a more significant effect in extensively heated systems. As phosphate residues associated with the amino acid sequence of caseins carry a negative charge that influences colloidal stability and protein-mineral interactions any dephosphorylation can be expected to have major consequences.</p>
</div>
</div>
</section>
<section id="controlling-heat-stability" class="level1">
<h1>Controlling Heat Stability</h1>
<p>The formulation and processing of dairy systems are modified for a variety of reasons. Sometimes these modification affect heat stability. This can be by design (in an effort to enhance stability) or by accident (to improve efficiency, marketability, etc.).</p>
<p>Some of the major factors that influence heat stability during formulation and processing are:</p>
<ul>
<li><strong>Pre-heating</strong>: controlled heating of milk to denature whey proteins and associate them with the casein micelle surface is often successfully used to create heat-stable milk powders</li>
<li><strong>Calcium-binders</strong>: the addition of polyvalent anions — such as phosphates and citrates — that bind ionic calcium is a common strategy to improve heat stability</li>
<li><strong>Sodium caseinate</strong>: recent studies have shown that this ingredent when added to milk can improve heat stability, likely due to the calcium-binding activity of caseinate</li>
<li><strong>Buffer addition</strong>: increasing the naturally-occurring levels of urea can mitigate against the effects of acidification by acting as a chemical precursor to ammonia, which has a buffering effect</li>
<li><strong>Concentration</strong>: the concentration of milk solids decreases heat stability. Generally, any increase in total protein, calcium or lactose also decreases heat stability.</li>
<li><strong>Increasing whey protein: casein ratio</strong>, which is common in infant formula, generally decreases stability</li>
</ul>
<p>While these factors are some of the most commonly encountered, a whole range of other factors have been studied in the literature, and you are encouraged to investigate these yourself when studying this material.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>